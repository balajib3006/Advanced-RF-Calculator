<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Advanced RF Calculator</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="stylesheet" href="style.css"/>
</head>
<body>

<main>
  <div class="tabs">
    <button class="tab-btn active" id="tabPatchBtn">Patch Antenna</button>
    <button class="tab-btn" id="tabLinkBtn">Link Budget</button>
  </div>

  <!-- PATCH -->
  <section id="tab-patch" class="panel">
    <form id="patchForm" onsubmit="return false;">
      <div class="grid">
        <div><label>Frequency (GHz)</label><input id="p_freq" type="number" step="any"><span class="hint">Center freq</span></div>
        <div><label>Dielectric (εr)</label><input id="p_er" type="number" step="any"></div>
        <div><label>Substrate height (mm)</label><input id="p_hmm" type="number" step="any"></div>
        <div><label>Loss tangent (tanδ)</label><input id="p_tanD" type="number" step="any"></div>
        <div><label>Desired feed Z₀ (Ω)</label><input id="p_Z0" type="number" step="any"></div>
        <div><label>Aperture efficiency η_ap</label><input id="p_etaap" type="number" step="any"></div>
        <div class="actions" style="grid-column:1/-1"><button onclick="calcPatch()">Calculate Patch</button><button onclick="clearPatch()">Clear</button></div>
      </div>
    </form>
    <div id="patchResults" class="cards"></div>
  </section>

<!-- LINK -->
<section id="tab-link" class="panel" style="display:none">
  <form id="linkForm" onsubmit="return false;">
    <div class="grid">

      <!-- Basic Link Inputs -->
      <div><label>Frequency (GHz)</label><input id="l_freq" type="number" step="any"></div>
      <div><label>Distance (m)</label><input id="l_dist" type="number" step="any"></div>

      <!-- Tx Power -->
      <div>
        <label>TX Power Value</label>
        <input id="l_txval" type="number" step="any">
        <span class="hint">Enter numerical value then pick units</span>
      </div>
      <div>
        <label>TX Power Units</label>
        <select id="l_txunit">
          <option>dBm</option>
          <option>W</option>
        </select>
      </div>

      <!-- Antennas -->
      <div><label>TX Gain (dBi)</label><input id="l_Gt" type="number" step="any"></div>
      <div><label>RX Gain (dBi)</label><input id="l_Gr" type="number" step="any"></div>
      <div><label>Antenna Efficiency η (0–1)</label><input id="l_eta" type="number" step="any"></div>
      <div><label>System Losses (dB)</label><input id="l_losses" type="number" step="any"></div>

      <!-- MIMO Parameters -->
      <div><label>Number of TX Antennas (Nt)</label><input id="l_Nt" type="number" step="1" value="1"></div>
      <div><label>Number of RX Antennas (Nr)</label><input id="l_Nr" type="number" step="1" value="1"></div>

      <!-- Environmental Losses -->
      <div><label>Atmospheric Loss (dB)</label><input id="l_Latm" type="number" step="any" value="0"></div>
      <div><label>Rain Loss (dB)</label><input id="l_Lrain" type="number" step="any" value="0"></div>
      <div><label>Foliage Loss (dB)</label><input id="l_Lfol" type="number" step="any" value="0"></div>
      <div><label>Clutter Loss (dB)</label><input id="l_Lclutter" type="number" step="any" value="0"></div>
      <div><label>Polarization Loss (dB)</label><input id="l_Lpol" type="number" step="any" value="0"></div>

      <!-- Noise / Sensitivity -->
      <div>
        <label>Bandwidth (Hz)</label>
        <input id="l_BW" type="number" step="any">
        <span class="hint">e.g., 2e6 for 2 MHz</span>
      </div>
      <div><label>Receiver Noise Figure NF (dB)</label><input id="l_NF" type="number" step="any"></div>
      <div><label>Required SNR (dB)</label><input id="l_reqSNR" type="number" step="any"></div>
      <div>
        <label>Modulation Presets</label>
        <select id="l_mod" onchange="applyModPreset()">
          <option value="">— choose modulation (fills Required SNR) —</option>
          <option value="3">BPSK / QPSK (3 dB)</option>
          <option value="8">QPSK robust (8 dB)</option>
          <option value="12">16-QAM (12 dB)</option>
          <option value="18">64-QAM (18 dB)</option>
          <option value="25">256-QAM (25 dB)</option>
        </select>
      </div>

      <!-- Sensitivity / Fade -->
      <div><label>Measured Sensitivity (dBm) — optional</label><input id="l_measSens" type="number" step="any" placeholder="leave blank if unknown"></div>
      <div><label>Target Fade Margin (dB)</label><input id="l_targetFade" type="number" step="any"></div>

      <!-- Channel Models -->
      <div>
        <label>Channel Model</label>
        <select id="l_channelModel">
          <option value="">None</option>
          <option value="hata">Hata</option>
          <option value="itu">ITU</option>
          <option value="cost231">COST231</option>
        </select>
      </div>

      <!-- Advanced Options -->
      <div><label>Temperature (K)</label><input id="l_temp" type="number" step="any" value="290"></div>
      <div><label>Implementation Margin (dB)</label><input id="l_implMargin" type="number" step="any" value="0"></div>
      <div><label>Shadow Fading (σ, dB)</label><input id="l_sigmaShadow" type="number" step="any" value="0"></div>

      <!-- Actions -->
      <div class="actions" style="grid-column:1/-1">
        <button onclick="calcLink()">Calculate Link</button>
        <button onclick="clearLink()">Clear</button>
      </div>
    </div>
  </form>

  <div id="linkResults" class="cards"></div>
</section>

</main>

<footer><div class="note">Engineering approximations only. Validate with measurement / EM simulation for production designs.</div></footer>

<script src="script.js"></script>
</body>
</html>
